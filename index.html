<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Okey 101 Skor Takip Sistemi (Tablo Aktif S√ºr√ºm)</title>
<style>
body{font-family:"Segoe UI",sans-serif;background:#f3f6fb;color:#2c3e50;margin:0}
h1{text-align:center;padding:20px;background:#4a90e2;color:#fff;margin:0 0 20px}
.container{max-width:1100px;margin:auto;background:#fff;border-radius:10px;
box-shadow:0 4px 10px rgba(0,0,0,.1);padding:20px}
label{display:block;margin-top:10px;font-weight:600}
input,select{padding:5px 8px;border-radius:6px;border:1px solid #ccc;width:100%;box-sizing:border-box}
table{width:100%;border-collapse:collapse;margin-top:20px}
th,td{border:1px solid #ddd;text-align:center;vertical-align:middle;padding:8px}
th{background:#4a90e2;color:#fff}
.btn{background:#4a90e2;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;margin-top:20px;font-weight:bold}
.btn:hover{background:#357ABD}
.hidden{display:none}
.section-title{background:#e9f0ff;padding:10px;font-weight:bold;margin-top:20px;border-radius:6px}
.player-cell{font-size:13px;text-align:center}
.kategori{border:1px solid #eee;margin:2px;padding:6px;border-radius:6px;background:#f9f9f9}
.kategori h4{margin:2px 0 6px;font-size:13px;color:#4a90e2}
.secenek{display:inline-block;margin:4px 6px;padding:3px 8px;border-radius:5px;cursor:pointer;transition:.2s}
.secenek:hover{background:#e0edff}
.secenek.aktif{background:#2ecc71;color:#fff;font-weight:bold}
.locked input,.locked .secenek,.locked button{pointer-events:none;opacity:.6}
.ceza-satiri{margin:4px 0}
.ceza-satiri button{width:26px;height:26px;border:none;border-radius:4px;cursor:pointer;color:#fff;font-weight:bold;font-size:14px}
.ceza-satiri .azalt{background:#e74c3c}
.ceza-satiri .azalt:hover{background:#c0392b}
.ceza-satiri .artir{background:#2ecc71}
.ceza-satiri .artir:hover{background:#27ae60}
input[type="number"]{width:70px;text-align:center}
</style>
</head>
<body>
<h1>üßÆ Okey 101 Skor Takip Sistemi</h1>

<!-- üéÆ Gƒ∞Rƒ∞≈û EKRANI (DEƒûƒ∞≈ûMEDƒ∞) -->
<div class="container" id="ayarEkrani">
  <div class="section-title">Oyun Ayarlarƒ±</div>
  <label>Oyun T√ºr√º:</label>
  <select id="oyunTuru" onchange="oyunTuruDegisti()">
    <option value="tek">Tekli</option>
    <option value="esli">E≈üli</option>
  </select>
  <div id="esliSecenekleri" class="hidden">
    <label>E≈üli Oyun Tipi:</label>
    <select id="esliTipi" onchange="oyunTuruDegisti()">
      <option value="birlikte">Birlikte (Takƒ±m puanƒ±)</option>
      <option value="ayri">Ayrƒ± Ayrƒ± (Bireysel puan)</option>
    </select>
  </div>
  <label>Ka√ß tur oynanacak?</label>
  <input type="number" id="turSayisi" min="1" max="50" value="10">
  <div class="section-title">Oyuncular / Takƒ±mlar</div>
  <div id="isimler"></div>
  <div class="section-title">Puanlama Ayarlarƒ±</div>
  <div style="display:flex;gap:10px;">
    <div style="width:48%;">
      <label>A√ßamama (+)</label><input type="number" id="p_acamama" value="202">
      <label>Bitirme (-)</label><input type="number" id="p_bitirme" value="-101">
      <label>Okey ile Bitirme (-)</label><input type="number" id="p_okeybit" value="-202">
      <label>√áiftle Bitirme (-)</label><input type="number" id="p_ciftbit" value="-202">
    </div>
    <div style="width:48%;">
      <label>Elden Bitirme (-)</label><input type="number" id="p_eldenbit" value="-202">
      <label>Elden Okey ile (-)</label><input type="number" id="p_eldenokey" value="-404">
      <label>√áiftle Okey ile (-)</label><input type="number" id="p_ciftokey" value="-404">
      <label>Masa A≈ütƒ± (-)</label><input type="number" id="p_masaAsma" value="-101">
    </div>
  </div>
  <div class="section-title">Ceza Puanlarƒ±</div>
  <div style="display:flex;gap:10px;">
    <div style="width:48%;">
      <label>ƒ∞≈ülek Atma (+)</label><input type="number" id="c_islek" value="101">
      <label>Okey Kaptƒ±rma (+)</label><input type="number" id="c_okeykaptir" value="101">
    </div>
    <div style="width:48%;">
      <label>Hatalƒ± A√ßma (+)</label><input type="number" id="c_hatali" value="101">
    </div>
  </div>
  <button class="btn" onclick="oyunaBasla()">OYUNA BA≈ûLA</button>
</div>

<!-- üßÆ OYUN EKRANI -->
<div class="container hidden" id="oyunEkrani">
  <div id="oyunBilgisi"></div>
  <table id="skorTablo"></table>
  <button class="btn" onclick="yeniOyun()">Yeni Oyun Ba≈ülat</button>
</div>

<script>
// === Gƒ∞Rƒ∞≈û ===
function oyunTuruDegisti(){
  const tur=document.getElementById("oyunTuru").value;
  const tip=document.getElementById("esliTipi")?document.getElementById("esliTipi").value:"birlikte";
  const esliSecenekleri=document.getElementById("esliSecenekleri");
  const isimler=document.getElementById("isimler");
  if(tur==="esli") esliSecenekleri.classList.remove("hidden");
  else esliSecenekleri.classList.add("hidden");

  if(tur==="tek"||(tur==="esli"&&tip==="ayri")){
    isimler.innerHTML=`
      <label>Oyuncu 1:</label><input id="oy1" value="Oyuncu 1">
      <label>Oyuncu 2:</label><input id="oy2" value="Oyuncu 2">
      <label>Oyuncu 3:</label><input id="oy3" value="Oyuncu 3">
      <label>Oyuncu 4:</label><input id="oy4" value="Oyuncu 4">`;
  } else {
    isimler.innerHTML=`
      <label>Takƒ±m 1:</label><input id="oy1" value="Takƒ±m 1">
      <label>Takƒ±m 2:</label><input id="oy3" value="Takƒ±m 2">`;
  }
}
oyunTuruDegisti();

// === OYUN BA≈ûLAT ===
function oyunaBasla(){
  const tur=document.getElementById("oyunTuru").value;
  const tip=document.getElementById("esliTipi")?document.getElementById("esliTipi").value:"birlikte";
  const turSayisi=parseInt(document.getElementById("turSayisi").value);
  const i1=document.getElementById("oy1").value;
  const i2=document.getElementById("oy2")?document.getElementById("oy2").value:"";
  const i3=document.getElementById("oy3").value;
  const i4=document.getElementById("oy4")?document.getElementById("oy4").value:"";
  let oyuncular=[];let takimlar=null;
  if(tur==="tek"){oyuncular=[i1,i2,i3,i4];}
  else if(tip==="birlikte"){oyuncular=[i1,i3];}
  else {oyuncular=[i1,i2,i3,i4];takimlar=[[0,1],[2,3]];}

  document.getElementById("ayarEkrani").classList.add("hidden");
  document.getElementById("oyunEkrani").classList.remove("hidden");
  document.getElementById("oyunBilgisi").innerHTML=`<h3>${tur==="tek"?"Tekli":"E≈üli"} (${tip}) | ${turSayisi} Tur</h3>`;

  let html="<tr><th>El</th>";
  oyuncular.forEach(o=>html+=`<th>${o}</th>`);
  html+="</tr>";

  for(let el=1;el<=turSayisi;el++){
    html+=`<tr data-el='${el}'><td><b>${el}</b></td>`;
    oyuncular.forEach((o,idx)=>{
      html+=`<td class='player-cell' data-el='${el}' data-oy='${idx}'>
        <div class='kategori kat1'>
          <h4>1Ô∏è‚É£ A√ßma Durumu</h4>
          <span class='secenek acmadi'>A√ßamadƒ±</span>
          <span>Elinde: <input type='number' class='elinde' min='0' max='200'></span>
        </div>
        <div class='kategori kat2'>
          <h4>2Ô∏è‚É£ Bitme T√ºr√º</h4>
          <span class='secenek bitme'>Bitti</span>
          <span class='secenek bitme'>Elden Bitti</span>
          <span class='secenek bitme'>√áiftle Bitti</span>
          <span class='secenek okey hidden'>Okey ile</span>
        </div>
        <div class='kategori kat3'>
          <h4>3Ô∏è‚É£ Cezalar / Masa A≈üƒ±mƒ±</h4>
          <span class='secenek masa'>Masa A≈ütƒ±</span>
          <div class='ceza-satiri'>ƒ∞≈ülek Atma:
            <button class='azalt'>-</button><span class='deger islek'>0</span><button class='artir'>+</button>
          </div>
          <div class='ceza-satiri'>Hatalƒ± A√ßma:
            <button class='azalt'>-</button><span class='deger hatali'>0</span><button class='artir'>+</button>
          </div>
          <div class='ceza-satiri'>Okey Kaptƒ±rma:
            <button class='azalt'>-</button><span class='deger kaptir'>0</span><button class='artir'>+</button>
          </div>
        </div>
      </td>`;
    });
    html+="</tr>";
  }
  document.getElementById("skorTablo").innerHTML = html;
  setTimeout(()=>aktiflestir(tur,tip,takimlar),100);
}

// === TABLO DAVRANI≈ûLARI ===
function aktiflestir(tur,tip,takimlar){
  document.querySelectorAll(".player-cell").forEach(cell=>{
    const acmadi=cell.querySelector(".acmadi");
    const elinde=cell.querySelector(".elinde");
    const kat1=cell.querySelector(".kat1");
    const kat2=cell.querySelector(".kat2");
    const bitmeler=kat2.querySelectorAll(".bitme");
    const okey=kat2.querySelector(".okey");
    const masaBtn=cell.querySelector(".masa");

    // A√ßamadƒ± & Elinde
    acmadi.onclick=()=>{acmadi.classList.toggle("aktif");elinde.disabled=acmadi.classList.contains("aktif");kat2.style.display=acmadi.classList.contains("aktif")?"none":"block";}
    elinde.oninput=()=>{if(elinde.value!==""){acmadi.style.display="none";kat2.style.display="none";}else{acmadi.style.display="inline-block";kat2.style.display="block";}}

    // Bitmeler
    bitmeler.forEach(bit=>bit.onclick=()=>{
      const aktif=bit.classList.contains("aktif");
      bitmeler.forEach(b=>{b.classList.remove("aktif");b.style.display="inline-block";});
      okey.classList.add("hidden");okey.classList.remove("aktif");
      if(!aktif){
        bit.classList.add("aktif");
        bitmeler.forEach(b=>{if(b!==bit)b.style.display="none";});
        kat1.style.display="none";
        okey.classList.remove("hidden");
        if(tur==="esli"&&tip==="ayri")takimEtkisi(cell,takimlar);
      } else {kat1.style.display="block";}
    });
    okey.onclick=()=>okey.classList.toggle("aktif");

    // Masa A≈ütƒ±
    masaBtn.onclick=()=>masaBtn.classList.toggle("aktif");

    // Cezalar
    cell.querySelectorAll(".ceza-satiri").forEach(r=>{
      const val=r.querySelector(".deger");
      r.querySelector(".azalt").onclick=()=>{let v=parseInt(val.textContent);if(v>0)val.textContent=v-1;}
      r.querySelector(".artir").onclick=()=>{let v=parseInt(val.textContent);val.textContent=v+1;}
    });
  });

  // Akƒ±llƒ± kilit
  const rows=document.querySelectorAll("#skorTablo tr");
  rows.forEach((r,i)=>{if(i===0)return;r.querySelectorAll("input,.secenek,button").forEach(el=>{
    el.oninput=()=>kilitKontrol(i);
    el.onclick=()=>kilitKontrol(i);
  });});
}

function takimEtkisi(cell,takimlar){
  const el=cell.dataset.el;
  const idx=parseInt(cell.dataset.oy);
  let partner=null;
  takimlar.forEach(t=>{if(t.includes(idx))partner=t.find(p=>p!==idx);});
  if(partner===null)return;
  const partnerCell=document.querySelector(`.player-cell[data-el='${el}'][data-oy='${partner}']`);
  if(!partnerCell)return;
  // partner sadece cezalara dokunabilsin
  partnerCell.querySelectorAll(".kat1,.kat2").forEach(k=>k.style.display="none");
  partnerCell.querySelectorAll(".bitme,.okey").forEach(b=>b.classList.remove("aktif"));
}

function kilitKontrol(i){
  const rows=document.querySelectorAll("#skorTablo tr");
  if(i<=1)return;
  const prev=rows[i-1],cur=rows[i];
  const has=rowHasData(cur);
  if(has&&!prev.classList.contains("locked")){
    prev.classList.add("locked");
    prev.querySelectorAll("input,.secenek,button").forEach(e=>e.disabled=true);
  } else if(!has&&prev.classList.contains("locked")){
    prev.classList.remove("locked");
    prev.querySelectorAll("input,.secenek,button").forEach(e=>e.disabled=false);
  }
}

function rowHasData(row){
  if(row.querySelector(".secenek.aktif"))return true;
  const v=row.querySelectorAll(".deger");
  for(const a of v) if(parseInt(a.textContent)>0)return true;
  const n=row.querySelectorAll("input[type='number']");
  for(const x of n) if(x.value!=="")return true;
  return false;
}

function yeniOyun(){
  document.getElementById("oyunEkrani").classList.add("hidden");
  document.getElementById("ayarEkrani").classList.remove("hidden");
  oyunTuruDegisti();
}
</script>
</body>
</html>